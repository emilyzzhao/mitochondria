<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emily Zhao">
<meta name="dcterms.date" content="2024-03-27">

<title>quarto-input0c7abf35</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Dataanalysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Dataanalysis_files/libs/quarto-html/quarto.js"></script>
<script src="Dataanalysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Dataanalysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Dataanalysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Dataanalysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Dataanalysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Dataanalysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Dataanalysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Dataanalysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
</head><body class="fullcontent">\usepackage{titling}
\pretitle{\vspace{-1.77cm}\begin{center}\Large}
\posttitle{\end{center}}

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>





<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><p>dPsi Data Analysis</p></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Emily Zhao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 27, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'data.table'

The following objects are masked from 'package:lubridate':

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from 'package:dplyr':

    between, first, last

The following object is masked from 'package:purrr':

    transpose</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load("~/projects/mitochondria/data/metabolicAssay.RData")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"~/OneDrive - Duke University/* SPRING 2024/STA 470S/mitochondria/data/metabolicAssay.RData"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>dPsi <span class="ot">&lt;-</span> dPsi[dPsi<span class="sc">$</span>dose <span class="sc">!=</span> <span class="sc">-</span><span class="fl">12.95</span>, ]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>dPsi <span class="ot">&lt;-</span> dPsi[<span class="sc">!</span><span class="fu">is.na</span>(dPsi<span class="sc">$</span>y), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualizations" class="level3">
<h3 class="anchored" data-anchor-id="visualizations">Visualizations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dPsi, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> y, <span class="at">color =</span> substrate)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose"</span>, <span class="at">y =</span> <span class="st">"dPsi"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Scatterplot of dPsi vs. Dose"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dPsi_GM <span class="ot">&lt;-</span> <span class="fu">subset</span>(dPsi, substrate <span class="sc">==</span> <span class="st">"GM"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dPsi_GM <span class="ot">&lt;-</span> <span class="fu">subset</span>(dPsi, substrate <span class="sc">==</span> <span class="st">"PM"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pop.mod &lt;- nls(y~a(c-(c-1)*exp(dose/b))),</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># + start=list(theta1 = 400, theta2 = -49, theta3 = 0.025),</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># + data=dPsi_Tg1, trace=TRUE)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pop.mod &lt;- nls(y~a(c-(c-1)*exp(dose/b))),</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># + start=list(theta1 = 400, theta2 = -49, theta3 = 0.025),</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># + data=dPsi_Tg1, trace=TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pop.mod &lt;- nls(y ~ SSlogis(dose, phi1, phi2, phi3), data = dPsi_Tg1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dPsi_GM, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> y, <span class="at">color =</span> geno)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose"</span>, <span class="at">y =</span> <span class="st">"dPsi"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Scatterplot of dPsi vs. Dose for substrate GM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lme4'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:nlme':

    lmList</code></pre>
</div>
</div>
</section>
<section id="model-specifications" class="level3">
<h3 class="anchored" data-anchor-id="model-specifications">Model specifications</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> dose<span class="sc">:</span>substrate <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>pair), <span class="at">data =</span> dPsi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model_PM &lt;- lmer(y ~ geno:dose + (1|pair), data = dPsi_PM)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ dose:substrate + (1 | pair)
   Data: dPsi

REML criterion at convergence: 1979.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.67675 -0.50306 -0.00011  0.50161  2.96035 

Random effects:
 Groups   Name        Variance Std.Dev.
 pair     (Intercept)  1.96    1.400   
 Residual             21.98    4.688   
Number of obs: 350, groups:  pair, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)              143.5311     1.4691  97.701
dose-13.65:substrateGM    -3.1162     1.9139  -1.628
dose-13.95:substrateGM     2.9616     1.9139   1.547
dose-14.19:substrateGM     6.8163     1.9139   3.561
dose-14.36:substrateGM     9.1342     1.9139   4.772
dose-14.49:substrateGM    10.2683     1.9139   5.365
dose-13.65:substratePM    -6.5934     1.9139  -3.445
dose-13.95:substratePM    -1.8939     1.9139  -0.990
dose-14.19:substratePM     1.0463     1.9139   0.547
dose-14.36:substratePM     2.6107     1.9139   1.364
dose-14.49:substratePM     3.3791     1.9139   1.766
dose-13.65:substratePcM  -13.5977     2.0103  -6.764
dose-13.95:substratePcM  -13.2039     2.0103  -6.568
dose-14.19:substratePcM  -13.6389     2.0103  -6.784
dose-14.36:substratePcM  -13.0999     2.0103  -6.516
dose-14.49:substratePcM  -12.8173     2.0103  -6.376
dose-13.65:substratePMPc  -3.6128     1.9139  -1.888
dose-13.95:substratePMPc   1.8188     1.9139   0.950
dose-14.19:substratePMPc   4.9527     1.9139   2.588
dose-14.36:substratePMPc   6.6713     1.9139   3.486
dose-14.49:substratePMPc   7.2273     1.9139   3.776
dose-13.65:substratePMOc  -4.2979     1.9139  -2.246
dose-13.95:substratePMOc   0.5641     1.9139   0.295
dose-14.19:substratePMOc   4.8555     1.9139   2.537
dose-14.36:substratePMOc   7.2839     1.9139   3.806
dose-14.49:substratePMOc   8.5678     1.9139   4.477
dose-13.65:substrateOcM  -13.5316     1.9139  -7.070
dose-13.95:substrateOcM   -8.0364     1.9139  -4.199
dose-14.19:substrateOcM   -4.3175     1.9139  -2.256
dose-14.36:substrateOcM   -1.7533     1.9139  -0.916</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 30 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>fit warnings:
fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> geno<span class="sc">:</span>dose<span class="sc">:</span>substrate <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>pair), <span class="at">data =</span> dPsi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ geno:dose:substrate + (1 | pair)
   Data: dPsi

REML criterion at convergence: 1735.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.5352 -0.6118 -0.0084  0.5920  3.2817 

Random effects:
 Groups   Name        Variance Std.Dev.
 pair     (Intercept)  2.063   1.436   
 Residual             15.559   3.944   
Number of obs: 350, groups:  pair, 6

Fixed effects:
                                 Estimate Std. Error t value
(Intercept)                     147.34768    1.71379  85.978
genoNT:dose-13.65:substrateGM    -7.84483    2.27735  -3.445
genoTg:dose-13.65:substrateGM    -6.02072    2.27735  -2.644
genoNT:dose-13.95:substrateGM    -2.76835    2.27735  -1.216
genoTg:dose-13.95:substrateGM     1.05835    2.27735   0.465
genoNT:dose-14.19:substrateGM     0.42995    2.27735   0.189
genoTg:dose-14.19:substrateGM     5.56960    2.27735   2.446
genoNT:dose-14.36:substrateGM     1.87233    2.27735   0.822
genoTg:dose-14.36:substrateGM     8.76303    2.27735   3.848
genoNT:dose-14.49:substrateGM     2.62208    2.27735   1.151
genoTg:dose-14.49:substrateGM    10.28133    2.27735   4.515
genoNT:dose-13.65:substratePM   -11.81895    2.27735  -5.190
genoTg:dose-13.65:substratePM    -9.00098    2.27735  -3.952
genoNT:dose-13.95:substratePM    -7.94908    2.27735  -3.490
genoTg:dose-13.95:substratePM    -3.47190    2.27735  -1.525
genoNT:dose-14.19:substratePM    -5.87200    2.27735  -2.578
genoTg:dose-14.19:substratePM     0.33143    2.27735   0.146
genoNT:dose-14.36:substratePM    -4.41982    2.27735  -1.941
genoTg:dose-14.36:substratePM     2.00818    2.27735   0.882
genoNT:dose-14.49:substratePM    -3.78993    2.27735  -1.664
genoTg:dose-14.49:substratePM     2.91493    2.27735   1.280
genoNT:dose-13.65:substratePcM  -20.31427    2.39039  -8.498
genoTg:dose-13.65:substratePcM  -14.50549    2.39039  -6.068
genoNT:dose-13.95:substratePcM  -18.71153    2.39039  -7.828
genoTg:dose-13.95:substratePcM  -15.32063    2.39039  -6.409
genoNT:dose-14.19:substratePcM  -19.94361    2.39039  -8.343
genoTg:dose-14.19:substratePcM  -14.95857    2.39039  -6.258
genoNT:dose-14.36:substratePcM  -19.57205    2.39039  -8.188
genoTg:dose-14.36:substratePcM  -14.25217    2.39039  -5.962
genoNT:dose-14.49:substratePcM  -19.29855    2.39039  -8.073
genoTg:dose-14.49:substratePcM  -13.96043    2.39039  -5.840
genoNT:dose-13.65:substratePMPc  -8.58930    2.27735  -3.772
genoTg:dose-13.65:substratePMPc  -6.26952    2.27735  -2.753
genoNT:dose-13.95:substratePMPc  -3.93735    2.27735  -1.729
genoTg:dose-13.95:substratePMPc  -0.05818    2.27735  -0.026
genoNT:dose-14.19:substratePMPc  -1.07153    2.27735  -0.471
genoTg:dose-14.19:substratePMPc   3.34378    2.27735   1.468
genoNT:dose-14.36:substratePMPc   0.09130    2.27735   0.040
genoTg:dose-14.36:substratePMPc   5.61823    2.27735   2.467
genoNT:dose-14.49:substratePMPc   0.50348    2.27735   0.221
genoTg:dose-14.49:substratePMPc   6.31803    2.27735   2.774
genoNT:dose-13.65:substratePMOc  -8.75133    2.27735  -3.843
genoTg:dose-13.65:substratePMOc  -7.47758    2.27735  -3.283
genoNT:dose-13.95:substratePMOc  -5.11867    2.27735  -2.248
genoTg:dose-13.95:substratePMOc  -1.38633    2.27735  -0.609
genoNT:dose-14.19:substratePMOc  -1.57850    2.27735  -0.693
genoTg:dose-14.19:substratePMOc   3.65635    2.27735   1.606
genoNT:dose-14.36:substratePMOc   0.26987    2.27735   0.119
genoTg:dose-14.36:substratePMOc   6.66490    2.27735   2.927
genoNT:dose-14.49:substratePMOc   0.90407    2.27735   0.397
genoTg:dose-14.49:substratePMOc   8.59848    2.27735   3.776
genoNT:dose-13.65:substrateOcM  -19.22688    2.27735  -8.443
genoTg:dose-13.65:substrateOcM  -15.46952    2.27735  -6.793
genoNT:dose-13.95:substrateOcM  -14.17893    2.27735  -6.226
genoTg:dose-13.95:substrateOcM   -9.52705    2.27735  -4.183
genoNT:dose-14.19:substrateOcM  -10.97637    2.27735  -4.820
genoTg:dose-14.19:substrateOcM   -5.29180    2.27735  -2.324
genoNT:dose-14.36:substrateOcM   -9.00098    2.27735  -3.952
genoTg:dose-14.36:substrateOcM   -2.13872    2.27735  -0.939
genoNT:dose-14.49:substrateOcM   -7.63312    2.27735  -3.352</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 60 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>fit warnings:
fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'dPsi' is your dataframe</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>fixed_effects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(model2)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dPsi, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> y, <span class="at">color =</span> geno)) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>substrate)<span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Add linear trend lines</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose"</span>, <span class="at">y =</span> <span class="st">"y"</span>, <span class="at">title =</span> <span class="st">"Scatterplot by Substrate with Trend Lines"</span>) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section" class="level1">
<h1></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y<span class="sc">~</span>substrate<span class="sc">:</span><span class="fu">poly</span>(dose,<span class="dv">2</span>)<span class="sc">:</span>geno <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>pair), <span class="at">data =</span> dPsi)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ substrate:poly(dose, 2):geno + (1 | pair)
   Data: dPsi

REML criterion at convergence: 2216.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.9237 -0.6521  0.1726  0.7107  2.5495 

Random effects:
 Groups   Name        Variance Std.Dev.
 pair     (Intercept)  2.564   1.601   
 Residual             62.063   7.878   
Number of obs: 350, groups:  pair, 6

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                         142.7357     0.7779 183.479
substrateGM:poly(dose, 2)1:genoNT    67.6638    26.9085   2.515
substratePM:poly(dose, 2)1:genoNT    51.8231    26.9085   1.926
substratePcM:poly(dose, 2)1:genoNT    3.0980    29.4768   0.105
substratePMPc:poly(dose, 2)1:genoNT  58.7733    26.9085   2.184
substratePMOc:poly(dose, 2)1:genoNT  65.3483    26.9085   2.429
substrateOcM:poly(dose, 2)1:genoNT   75.0480    26.9085   2.789
substrateGM:poly(dose, 2)2:genoNT   -23.2761    26.9085  -0.865
substratePM:poly(dose, 2)2:genoNT   -15.8870    26.9085  -0.590
substratePcM:poly(dose, 2)2:genoNT   -2.3587    29.4768  -0.080
substratePMPc:poly(dose, 2)2:genoNT -22.7688    26.9085  -0.846
substratePMOc:poly(dose, 2)2:genoNT -17.1925    26.9085  -0.639
substrateOcM:poly(dose, 2)2:genoNT  -19.2019    26.9085  -0.714
substrateGM:poly(dose, 2)1:genoTg   106.6470    26.9085   3.963
substratePM:poly(dose, 2)1:genoTg    77.5520    26.9085   2.882
substratePcM:poly(dose, 2)1:genoTg    5.7111    29.4768   0.194
substratePMPc:poly(dose, 2)1:genoTg  81.6254    26.9085   3.033
substratePMOc:poly(dose, 2)1:genoTg 106.3681    26.9085   3.953
substrateOcM:poly(dose, 2)1:genoTg  101.4047    26.9085   3.769
substrateGM:poly(dose, 2)2:genoTg   -27.8152    26.9085  -1.034
substratePM:poly(dose, 2)2:genoTg   -25.4269    26.9085  -0.945
substratePcM:poly(dose, 2)2:genoTg    5.7201    29.4768   0.194
substratePMPc:poly(dose, 2)2:genoTg -27.1695    26.9085  -1.010
substratePMOc:poly(dose, 2)2:genoTg -23.1421    26.9085  -0.860
substrateOcM:poly(dose, 2)2:genoTg  -19.4307    26.9085  -0.722</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Correlation matrix not shown by default, as p = 25 &gt; 12.
Use print(x, correlation=TRUE)  or
    vcov(x)        if you need it</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> substrate<span class="sc">:</span><span class="fu">poly</span>(dose,<span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>pair), <span class="at">data =</span> dPsi)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ -1 + substrate:poly(dose, 2) + (1 | pair)
   Data: dPsi

REML criterion at convergence: 2383.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0346 -0.6098  0.1929  0.7100  2.2724 

Random effects:
 Groups   Name        Variance Std.Dev.
 pair     (Intercept) 20381.9  142.765 
 Residual                60.5    7.778 
Number of obs: 350, groups:  pair, 6

Fixed effects:
                             Estimate Std. Error t value
substrateGM:poly(dose, 2)1     87.155     18.786   4.639
substratePM:poly(dose, 2)1     64.688     18.786   3.443
substratePcM:poly(dose, 2)1     4.405     20.579   0.214
substratePMPc:poly(dose, 2)1   70.199     18.786   3.737
substratePMOc:poly(dose, 2)1   85.858     18.786   4.570
substrateOcM:poly(dose, 2)1    88.226     18.786   4.696
substrateGM:poly(dose, 2)2    -25.546     18.786  -1.360
substratePM:poly(dose, 2)2    -20.657     18.786  -1.100
substratePcM:poly(dose, 2)2     1.681     20.579   0.082
substratePMPc:poly(dose, 2)2  -24.969     18.786  -1.329
substratePMOc:poly(dose, 2)2  -20.167     18.786  -1.074
substrateOcM:poly(dose, 2)2   -19.316     18.786  -1.028

Correlation of Fixed Effects:
                sGM:(,2)1 sbstrtPM:p(,2)1 sbstrtPcM:(,2)1 sPMP:(,2)1 sPMO:(,2)1
sbstrtPM:p(,2)1 0.000                                                          
sbstrtPcM:(,2)1 0.000     0.000                                                
sbPMP:(,2)1     0.000     0.000           0.000                                
sbPMO:(,2)1     0.000     0.000           0.000           0.000                
sbsOM:(,2)1     0.000     0.000           0.000           0.000      0.000     
sbsGM:(,2)2     0.000     0.000           0.000           0.000      0.000     
sbstrtPM:p(,2)2 0.000     0.000           0.000           0.000      0.000     
sbstrtPcM:(,2)2 0.000     0.000           0.000           0.000      0.000     
sbPMP:(,2)2     0.000     0.000           0.000           0.000      0.000     
sbPMO:(,2)2     0.000     0.000           0.000           0.000      0.000     
sbsOM:(,2)2     0.000     0.000           0.000           0.000      0.000     
                sOM:(,2)1 sGM:(,2)2 sbstrtPM:p(,2)2 sbstrtPcM:(,2)2 sPMP:(,2)2
sbstrtPM:p(,2)1                                                               
sbstrtPcM:(,2)1                                                               
sbPMP:(,2)1                                                                   
sbPMO:(,2)1                                                                   
sbsOM:(,2)1                                                                   
sbsGM:(,2)2     0.000                                                         
sbstrtPM:p(,2)2 0.000     0.000                                               
sbstrtPcM:(,2)2 0.000     0.000     0.000                                     
sbPMP:(,2)2     0.000     0.000     0.000           0.000                     
sbPMO:(,2)2     0.000     0.000     0.000           0.000           0.000     
sbsOM:(,2)2     0.000     0.000     0.000           0.000           0.000     
                sPMO:(,2)2
sbstrtPM:p(,2)1           
sbstrtPcM:(,2)1           
sbPMP:(,2)1               
sbPMO:(,2)1               
sbsOM:(,2)1               
sbsGM:(,2)2               
sbstrtPM:p(,2)2           
sbstrtPcM:(,2)2           
sbPMP:(,2)2               
sbPMO:(,2)2               
sbsOM:(,2)2     0.000     </code></pre>
</div>
</div>
<section id="pbkr" class="level3">
<h3 class="anchored" data-anchor-id="pbkr">pbkr</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pbkrtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model 1 vs.&nbsp;Model 2: model 2 wins</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood ratio test</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>lrt_result_12 <span class="ot">&lt;-</span> <span class="fu">KRmodcomp</span>(model2, model1)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>lrt_result_12</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>large : y ~ geno:dose:substrate + (1 | pair)
small : y ~ dose:substrate + (1 | pair)
          stat      ndf      ddf F.scaling   p.value    
Ftest   5.3331  30.0000 285.0004         1 6.451e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>difference in # of parameters between models (ndf) = 10</p></li>
<li><p>p-value = &lt; 2.2e-16</p>
<ul>
<li>highly significant -&gt; inclusion of geno term significantly improves fit of model over model1</li>
</ul></li>
</ul>
<p>Model 3 vs.&nbsp;Model 4: model 3 wins</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lrt_result_34 <span class="ot">&lt;-</span> <span class="fu">KRmodcomp</span>(model4, model3)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>lrt_result_34</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>large : y ~ substrate:poly(dose, 2):geno + (1 | pair)
small : y ~ -1 + substrate:poly(dose, 2) + (1 | pair)
         stat     ndf     ddf F.scaling   p.value    
Ftest 2525.03   13.00  164.61   0.97529 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>p-value = &lt; 2.2e-16</p>
<ul>
<li>highly significant -&gt; inclusion of gennotype term significantly improves fit of model over model1</li>
</ul></li>
</ul>
</section>
<section id="gam" class="level3">
<h3 class="anchored" data-anchor-id="gam">GAM</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is mgcv 1.9-0. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>dose <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dPsi<span class="sc">$</span>dose)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>substrate <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dPsi<span class="sc">$</span>substrate)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>geno <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dPsi<span class="sc">$</span>geno)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#gam_model &lt;- gam(y ~ dose:substrate:geno + s(pair, bs = "re"), data = dPsi)</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(gam_model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(gam_model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variable that combines geno and substrate</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>geno_substrate <span class="ot">&lt;-</span> <span class="fu">interaction</span>(dPsi<span class="sc">$</span>geno, dPsi<span class="sc">$</span>substrate)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check distribution of data</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dPsi<span class="sc">$</span>geno_substrate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  NT.GM   Tg.GM   NT.PM   Tg.PM  NT.PcM  Tg.PcM NT.PMPc Tg.PMPc NT.PMOc Tg.PMOc 
     30      30      30      30      25      25      30      30      30      30 
 NT.OcM  Tg.OcM 
     30      30 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This model doesn't work (see notes below)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#gam_model &lt;- gam(y ~ s(dose, bs="tp", by=geno_substrate) + s(pair, bs="re"), data = dPsi) </span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(dPsi<span class="sc">$</span>dose))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>Notes</p>
<ul>
<li>using <code>bs="tp"</code> (tensor product smoothing) leads to an error because there are only 5 unique “dose” values -&gt; leads to overfitting and error</li>
</ul>
<p>Reduce degrees of freedom to <span class="math inline">\(k-1=3\)</span> (<code>k=4</code>) to specify max number of basis functions</p>
<ul>
<li>the number of basis functions (4) shouldn’t exceed the number of unique dose values (5)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gam_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(dose, <span class="at">bs=</span><span class="st">"tp"</span>, <span class="at">k=</span><span class="dv">4</span>, <span class="at">by=</span>geno_substrate) <span class="sc">+</span> <span class="fu">s</span>(pair, <span class="at">bs=</span><span class="st">"re"</span>), <span class="at">data =</span> dPsi)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
y ~ s(dose, bs = "tp", k = 4, by = geno_substrate) + s(pair, 
    bs = "re")

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 142.7364     0.7856   181.7   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
                               edf Ref.df      F  p-value    
s(dose):geno_substrateNT.GM   1.00      1  6.420 0.011742 *  
s(dose):geno_substrateTg.GM   1.00      1 15.949 8.04e-05 ***
s(dose):geno_substrateNT.PM   1.00      1  3.766 0.053149 .  
s(dose):geno_substrateTg.PM   1.00      1  8.434 0.003929 ** 
s(dose):geno_substrateNT.PcM  1.00      1  0.011 0.915725    
s(dose):geno_substrateTg.PcM  1.00      1  0.038 0.845335    
s(dose):geno_substrateNT.PMPc 1.00      1  4.844 0.028431 *  
s(dose):geno_substrateTg.PMPc 1.00      1  9.343 0.002420 ** 
s(dose):geno_substrateNT.PMOc 1.00      1  5.988 0.014918 *  
s(dose):geno_substrateTg.PMOc 1.00      1 15.865 8.38e-05 ***
s(dose):geno_substrateNT.OcM  1.00      1  7.898 0.005242 ** 
s(dose):geno_substrateTg.OcM  1.00      1 14.419 0.000174 ***
s(pair)                       3.58      5  2.436 0.005186 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.211   Deviance explained = 24.6%
GCV = 64.165  Scale est. = 61.126    n = 350</code></pre>
</div>
</div>
<p>Plot <code>gam_model</code></p>
<ul>
<li>notes: model looks very sketchy - will need diagnostics</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>fitted_values <span class="ot">&lt;-</span> <span class="fu">fitted</span>(gam_model)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of original data</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dPsi, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>y, <span class="at">color=</span>geno_substrate)) <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of Dose by genotype-substrate"</span>, <span class="at">x =</span> <span class="st">"Dose"</span>, <span class="at">y =</span> <span class="st">"Response"</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlay the fitted curve</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted_values), <span class="at">color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Model diagnostics: <code>gam_model</code></p>
<ul>
<li><p>both plots indicate some sort of curve in the pattern of residuals for both fitted values and for predictors</p></li>
<li><p>so maybe there’s something about the data that the GAM isn’t capturing?</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals vs. fitted values</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>dPsi<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(gam_model)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dPsi, <span class="fu">aes</span>(<span class="at">x=</span>fitted_values, <span class="at">y=</span>residuals)) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted Values"</span>, <span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals vs. each predictor</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dPsi, <span class="fu">aes</span>(<span class="at">x=</span>dose, <span class="at">y=</span>residuals)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Dose"</span>, <span class="at">x =</span> <span class="st">"Dose"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Dataanalysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="graveyard" class="level3">
<h3 class="anchored" data-anchor-id="graveyard">Graveyard</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Provide initial parameter estimates</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>initial_params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">170</span>, <span class="at">b =</span> <span class="dv">120</span>, <span class="at">c =</span> <span class="sc">-</span><span class="fl">14.19</span>, <span class="at">d =</span> <span class="dv">6</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># not working, either if there's initial params or removed, nothing is working</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with initial parameter estimates</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">#self_start_model &lt;- nls(as.numeric(y) ~ SSfpl(as.numeric(dose), a, b, c, d)|geno, data = dPsi_GM, start = initial_params)</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">#selfstartmodel1 &lt;- nls(y~SSgompertz(as.numeric(dose), Asym=170, b2, b3)|geno, data=dPsi_GM)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>plot(density ~ log(conc), DNase.1, # xlim = c(0, 21), main = “SSgompertz() fit to DNase.1”) ux &lt;- par(“usr”)[1:2]; x &lt;- seq(ux[1], ux[2], length.out=250) lines(x, do.call(SSgompertz, c(list(x=x), coef(fm1))), col = “red”, lwd=2) As &lt;- coef(fm1)[[“Asym”]]; abline(v = 0, h = 0, lty = 3) axis(2, at= exp(-coef(fm1)[[“b2”]]), quote(e^{-b[2]}), las=1, pos=0)</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>